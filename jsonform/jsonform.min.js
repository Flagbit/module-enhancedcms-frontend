(function(){function a(b,c,d){if(b===c)return 0!==b||1/b==1/c;if(null==b||null==c)return b===c;if(b._chain&&(b=b._wrapped),c._chain&&(c=c._wrapped),b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(c);if(c.isEqual&&x.isFunction(c.isEqual))return c.isEqual(b);var e=j.call(b);if(e!=j.call(c))return!1;switch(e){case"[object String]":return b==String(c);case"[object Number]":return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case"[object Date]":case"[object Boolean]":return+b==+c;case"[object RegExp]":return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==b)return!0;d.push(b);var g=0,h=!0;if("[object Array]"==e){if(g=b.length,h=g==c.length)for(;g--&&(h=g in b==g in c&&a(b[g],c[g],d)););}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return!1;for(var i in b)if(x.has(b,i)&&(g++,!(h=x.has(c,i)&&a(b[i],c[i],d))))break;if(h){for(i in c)if(x.has(c,i)&&!g--)break;h=!g}}return d.pop(),h}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new I(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):b._=x,x.VERSION="1.3.3";var y=x.each=x.forEach=function(a,b,c){if(null!=a)if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(c,a[e],e,a)===d)return}else for(var g in a)if(x.has(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return null==a?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,c){var e=!0;return null==a?e:q&&a.every===q?a.every(b,c):(y(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),!!e)};var z=x.some=x.any=function(a,b,c){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,c):(y(a,function(a,f,g){if(e||(e=b.call(c,a,f,g)))return d}),!!e)};x.include=x.contains=function(a,b){var c=!1;return null==a?c:s&&a.indexOf===s?a.indexOf(b)!=-1:c=z(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(x.isFunction(b)?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-(1/0);var d={computed:-(1/0)};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=[];return y(a,function(a,d,e){b=Math.floor(Math.random()*(d+1)),c[d]=c[b],c[b]=a}),c},x.sortBy=function(a,b,c){var d=x.isFunction(b)?b:function(a){return a[b]};return x.pluck(x.map(a,function(a,b,e){return{value:a,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return void 0===c?1:void 0===d?-1:c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);for(var d=0,e=a.length;d<e;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?x.isArray(a)?h.call(a):x.isArguments(a)?h.call(a):a.toArray&&x.isFunction(a.toArray)?a.toArray():x.values(a):[]},x.size=function(a){return x.isArray(a)?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return a.length<3&&(b=!0),x.reduce(d,function(c,d,f){return(b?x.last(c)===d&&c.length:x.include(c,d))||(c.push(d),e.push(a[f])),c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(h.call(arguments,1),!0);return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b),d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(null==a)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);e<d;)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(a,b){var c,d;if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return d=h.call(arguments,2),c=function(){if(!(this instanceof c))return a.apply(b,d.concat(h.call(arguments)));A.prototype=a.prototype;var e=new A,f=a.apply(e,d.concat(h.call(arguments)));return Object(f)===f?f:e}},x.bindAll=function(a){var b=h.call(arguments,1);return 0==b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h,i=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var j=function(){e=null,g&&a.apply(c,d),i()};return e||(e=setTimeout(j,b)),f?g=!0:h=a.apply(c,d),i(),f=!0,h}},x.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments,0));return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={};return y(x.flatten(h.call(arguments,1)),function(c){c in a&&(b[c]=a[c])}),b},x.defaults=function(a){return y(h.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(b,c){return a(b,c,[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!=a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return"[object Arguments]"==j.call(a)},x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),x.isFunction=function(a){return"[object Function]"==j.call(a)},x.isString=function(a){return"[object String]"==j.call(a)},x.isNumber=function(a){return"[object Number]"==j.call(a)},x.isFinite=function(a){return x.isNumber(a)&&isFinite(a)},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isDate=function(a){return"[object Date]"==j.call(a)},x.isRegExp=function(a){return"[object RegExp]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return b._=c,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.result=function(a,b){if(null==a)return null;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){K(b,x[b]=a[b])})};var B=0;x.uniqueId=function(a){var b=B++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var E in D)D[D[E]]=E;var F=/\\|'|\r|\n|\t|\u2028|\u2029/g,G=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(a){return a.replace(G,function(a,b){return D[b]})};x.template=function(a,b,c){c=x.defaults(c||{},x.templateSettings);var d="__p+='"+a.replace(F,function(a){return"\\"+D[a]}).replace(c.escape||C,function(a,b){return"'+\n_.escape("+H(b)+")+\n'"}).replace(c.interpolate||C,function(a,b){return"'+\n("+H(b)+")+\n'"}).replace(c.evaluate||C,function(a,b){return"';\n"+H(b)+"\n;__p+='"})+"';\n";c.variable||(d="with(obj||{}){\n"+d+"}\n"),d="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+d+"return __p;\n";var e=new Function(c.variable||"obj","_",d);if(b)return e(b,x);var f=function(a){return e.call(this,a,x)};return f.source="function("+(c.variable||"obj")+"){\n"+d+"}",f},x.chain=function(a){return x(a).chain()};var I=function(a){this._wrapped=a};x.prototype=I.prototype;var J=function(a,b){return b?x(a).chain():a},K=function(a,b){I.prototype[a]=function(){var a=h.call(arguments);return i.call(a,this._wrapped),J(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];I.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return"shift"!=a&&"splice"!=a||0!==d||delete c[0],J(c,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];I.prototype[a]=function(){return J(b.apply(this._wrapped,arguments),this._chain)}}),I.prototype.chain=function(){return this._chain=!0,this},I.prototype.value=function(){return this._wrapped}}).call(this),function(a,b,c,d,e){a&&(d=require("underscore"));var f=/\[([0-9]*)\](?=\[|\.|$)/g,g={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},h={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g},i=function(a){return!(d.isUndefined(a)||d.isNull(a))},j={util:{}},k=function(a){return i(a)?(a=""+a,a?a.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):""):""},l=function(a){return a.replace(/([ \!\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1")},m=function(a){var b=function(a,b){b.find("> .active").removeClass("active"),a.addClass("active")},d=function(a,b){a.find("input, textarea, select").removeAttr("disabled"),a.parent().children(":not([data-idx="+b+"])").find("input, textarea, select").attr("disabled","disabled")},e=function(a){var e,f=c("option:selected",c(this)),g=c(this),h=f.get(0).getAttribute("data-idx")||f.attr("value");a.preventDefault(),f.hasClass("active")||(e=c(this).parents(".tabbable").eq(0).find(".tab-content [data-idx="+h+"]"),b(f,g),b(e,e.parent()),d(e,h))},f=function(a){var e=(c("a",c(this)),c(this).parents(".tabbable").first().find(".tab-content").first()),f=c(this).index(),g=e.find("[data-idx="+f+"]");a.preventDefault(),b(c(this),c(this).parent()),b(g,g.parent()),c(this).parent().hasClass("jsonform-alternative")&&d(g,f)};a.each(function(){c(this).delegate("select.nav","change",e),c(this).find("select.nav").each(function(){c(this).val(c(this).find(".active").attr("value"));var a=c(this).find("option:selected").get(0).getAttribute("data-idx")||c(this).find("option:selected").attr("value"),b=c(this).parents(".tabbable").eq(0).find(".tab-content [data-idx="+a+"]");d(b,a)}),c(this).delegate("ul.nav li","click",f),c(this).find("ul.nav li.active").click()})};j.fieldTemplate=function(a){return'<div class="control-group jsonform-error-<%= keydash %><%= elt.htmlClass ? " " + elt.htmlClass : "" %><%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== "boolean") ? " jsonform-required" : "") %><%= (node.readOnly ? " jsonform-readonly" : "") %><%= (node.disabled ? " jsonform-disabled" : "") %>"><% if (node.title && !elt.notitle) { %><label class="control-label" for="<%= node.id %>"><%= node.title %></label><% } %><div class="controls"><% if (node.prepend || node.append) { %><div class="<% if (node.prepend) { %>input-prepend<% } %><% if (node.append) { %> input-append<% } %>"><% if (node.prepend) { %><span class="add-on"><%= node.prepend %></span><% } %><% } %>'+a+'<% if (node.append) { %><span class="add-on"><%= node.append %></span><% } %><% if (node.prepend || node.append) { %></div><% } %><% if (node.description) { %><span class="help-inline"><%= node.description %></span><% } %><span class="help-block jsonform-errortext" style="display:none;"></span></div></div>'};var n='<div class="_jsonform-preview"><% if (value.type=="image") { %><img class="jsonform-preview" id="jsonformpreview-<%= id %>" src="<%= value.url %>" /><% } else { %><a href="<%= value.url %>"><%= value.name %></a> (<%= Math.ceil(value.size/1024) %>kB)<% } %></div><a href="#" class="btn _jsonform-delete"><i class="icon-remove" title="Remove"></i></a> ',o=function(a){return{template:'<input type="'+a+'" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.readOnly ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== "boolean") ? " required=\'required\'" : "") %><%= (node.placeholder? "placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%> />',fieldtemplate:!0,inputfield:!0}};j.elementTypes={none:{template:""},root:{template:"<div><%= children %></div>"},text:o("text"),password:o("password"),date:o("date"),datetime:o("datetime"),"datetime-local":o("datetime-local"),email:o("email"),month:o("month"),number:o("number"),search:o("search"),tel:o("tel"),time:o("time"),url:o("url"),week:o("week"),range:{template:'<input type="range" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%> min=<%= range.min %> max=<%= range.max %> step=<%= range.step %><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %> />',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(a,b){a.range={min:1,max:100,step:1},b&&b.schemaElement&&(b.formElement&&b.formElement.step&&(a.range.step=b.formElement.step),"undefined"!=typeof b.schemaElement.minimum&&(b.schemaElement.exclusiveMinimum?a.range.min=b.schemaElement.minimum+a.range.step:a.range.min=b.schemaElement.minimum),"undefined"!=typeof b.schemaElement.maximum&&(b.schemaElement.exclusiveMaximum?a.range.max=b.schemaElement.maximum+a.range.step:a.range.max=b.schemaElement.maximum))}},color:{template:'<input type="text" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %> />',fieldtemplate:!0,inputfield:!0,onInsert:function(a,b){c(b.el).find("#"+l(b.id)).spectrum({preferredFormat:"hex",showInput:!0})}},textarea:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "150px" %>;width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%><%= (node.readOnly ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %><%= (node.placeholder? "placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0},wysihtml5:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "300px" %>;width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%><%= (node.readOnly ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %><%= (node.placeholder? "placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0,onInsert:function(a,b){var d=function(){c(b.el).data("wysihtml5")||(c(b.el).data("wysihtml5_loaded",!0),c(b.el).find("#"+l(b.id)).wysihtml5({html:!0,link:!0,"font-styles":!0,image:!0,events:{load:function(){c(this.textareaElement).removeAttr("required")}}}))};if(window.jsonform_wysihtml5_setup)return void window.jsonform_wysihtml5_setup(d);var e=window.setInterval(function(){window.wysihtml5&&(window.clearInterval(e),d())},1e3)}},ace:{template:'<div id="<%= id %>" style="position:relative;height:<%= elt.height || "300px" %>;"><div id="<%= id %>__ace" style="width:<%= elt.width || "100%" %>;height:<%= elt.height || "300px" %>;"></div><input type="hidden" name="<%= node.name %>" id="<%= id %>__hidden" value="<%= escape(value) %>"/></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(a,b){var e=function(){var a=b.formElement||{},e=window.ace,f=e.edit(c(b.el).find("#"+l(b.id)+"__ace").get(0)),g="#"+l(b.id)+"__hidden";f.getSession().setNewLineMode("unix"),f.renderer.setShowPrintMargin(!1),f.setTheme("ace/theme/"+(a.aceTheme||"twilight")),a.aceMode&&f.getSession().setMode("ace/mode/"+a.aceMode),f.getSession().setTabSize(2),f.getSession().setValue(b.value||"");var h=d.debounce(function(){c(b.el).find(g).val(f.getSession().getValue()),c(b.el).find(g).change()},600);f.getSession().on("change",h),f.on("blur",function(){c(b.el).find(g).change(),c(b.el).find(g).trigger("blur")}),f.on("focus",function(){c(b.el).find(g).trigger("focus")})};if(window.jsonform_ace_setup)return void window.jsonform_ace_setup(e);var f=window.setInterval(function(){window.ace&&(window.clearInterval(f),e())},1e3)}},checkbox:{template:'<label class="checkbox"><input type="checkbox" id="<%= id %>" name="<%= node.name %>" value="1" <% if (value) {%>checked<% } %><%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== "boolean") ? " required=\'required\'" : "") %> /><span><%= node.inlinetitle || "" %></span></label>',fieldtemplate:!0,inputfield:!0,getElement:function(a){return c(a).parent().get(0)}},file:{template:'<input class="input-file" id="<%= id %>" name="<%= node.name %>" type="file" <%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %>/>',fieldtemplate:!0,inputfield:!0},"file-hosted-public":{template:"<span><% if (value && (value.type||value.url)) { %>"+n+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="<%= transloaditname %>" /><input data-transloadit-name="_transloadit_<%= transloaditname %>" type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(a){return c(a).parent().get(0)},onBeforeRender:function(a,b){b.ownerTree._transloadit_generic_public_index?b.ownerTree._transloadit_generic_public_index++:b.ownerTree._transloadit_generic_public_index=1,a.transloaditname="_transloadit_jsonform_genericupload_public_"+b.ownerTree._transloadit_generic_public_index,b.ownerTree._transloadit_generic_elts||(b.ownerTree._transloadit_generic_elts={}),b.ownerTree._transloadit_generic_elts[a.transloaditname]=b},onChange:function(a,b){if(b.ownerTree._transloadit_bound)return!1;b.ownerTree._transloadit_bound=!0;var f=c(b.ownerTree.domRoot);f.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(a){var c=d.values(a.results);c=d.flatten(c),d.each(c,function(a){var c=b.ownerTree._transloadit_generic_elts[a.field].id,g=f.find("#"+l(c)),h=d.filter(d.keys(a.meta),function(b){return!!i(a.meta[b])});a.meta=d.pick(a.meta,h),g.val(e.stringify(a))}),b.ownerTree._transloadit_bound=!1,f.unbind("submit.transloadit"),d.delay(function(){console.log("submit form"),b.ownerTree.submit()},10)},onError:function(a){console.log("assembly error",a)}})},onInsert:function(a,b){c(b.el).find("a._jsonform-delete").on("click",function(a){return c(b.el).find("._jsonform-preview").remove(),c(b.el).find("a._jsonform-delete").remove(),c(b.el).find("#"+l(b.id)).val(""),a.preventDefault(),!1})},onSubmit:function(a,b){return!b.ownerTree._transloadit_bound}},"file-transloadit":{template:"<span><% if (value && (value.type||value.url)) { %>"+n+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="_transloadit_<%= node.name %>" /><input type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(a){return c(a).parent().get(0)},onChange:function(a,b){if(b.ownerTree._transloadit_bound)return!1;b.ownerTree._transloadit_bound=!0;var f=c(b.ownerTree.domRoot);f.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(a){var c=d.values(a.results);c=d.flatten(c),d.each(c,function(a){var b=f.find('input[name="'+a.field.replace(/^_transloadit_/,"")+'"]'),c=d.filter(d.keys(a.meta),function(b){return!!i(a.meta[b])});a.meta=d.pick(a.meta,c),b.val(e.stringify(a))}),b.ownerTree._transloadit_bound=!1,f.unbind("submit.transloadit"),d.delay(function(){console.log("submit form"),b.ownerTree.submit()},10)},onError:function(a){console.log("assembly error",a)}})},onInsert:function(a,b){c(b.el).find("a._jsonform-delete").on("click",function(a){return c(b.el).find("._jsonform-preview").remove(),c(b.el).find("a._jsonform-delete").remove(),c(b.el).find("#"+l(b.id)).val(""),a.preventDefault(),!1})},onSubmit:function(a,b){return!b.ownerTree._transloadit_bound}},select:{template:'<select name="<%= node.name %>" id="<%= id %>"<%= (fieldHtmlClass ? " class=\'" + fieldHtmlClass + "\'" : "") %><%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %>> <% _.each(node.options, function(key, val) { if(key instanceof Object) { if (value === key.value) { %> <option selected value="<%= key.value %>"><%= key.title %></option> <% } else { %> <option value="<%= key.value %>"><%= key.title %></option> <% }} else { if (value === key) { %> <option selected value="<%= key %>"><%= key %></option> <% } else { %><option value="<%= key %>"><%= key %></option> <% }}}); %> </select>',fieldtemplate:!0,inputfield:!0},imageselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="btn<% if (buttonClass && node.value) { %> <%= buttonClass %><% } %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><img src="<% if (!node.value.match(/^https?:/)) { %><%= prefix %><% } %><%= node.value %><%= suffix %>" alt="" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.each(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="btn<% if (buttonClass) { %> <%= buttonClass %><% } %>" style="max-width:<%= width %>px;max-height:<%= height %>px"><% if (key instanceof Object) { %><img src="<% if (!key.value.match(/^https?:/)) { %><%= prefix %><% } %><%= key.value %><%= suffix %>" alt="<%= key.title %>" /></a><% } else { %><img src="<% if (!key.match(/^https?:/)) { %><%= prefix %><% } %><%= key %><%= suffix %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="btn">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(a,b){var c=b.formElement||{},d=null,e=c.imageSelectorColumns||5;a.buttonTitle=c.imageSelectorTitle||"Select...",a.prefix=c.imagePrefix||"",a.suffix=c.imageSuffix||"",a.width=c.imageWidth||32,a.height=c.imageHeight||32,a.buttonClass=c.imageButtonClass||!1,b.options.length>e?(d=Math.ceil(b.options.length/e),a.columns=Math.ceil(b.options.length/d)):a.columns=e},getElement:function(a){return c(a).parent().get(0)},onInsert:function(a,b){c(b.el).on("click",".dropdown-menu a",function(a){a.preventDefault(),a.stopPropagation();var d="img"===a.target.nodeName.toLowerCase()?c(a.target):c(a.target).find("img"),e=d.attr("src"),f=b.formElement||{},g=f.imagePrefix||"",h=f.imageSuffix||"",i=f.imageWidth||32,j=f.imageHeight||32;e?(0===e.indexOf(g)&&(e=e.substring(g.length)),e=e.substring(0,e.length-h.length),c(b.el).find("input").attr("value",e),c(b.el).find('a[data-toggle="dropdown"]').addClass(f.imageButtonClass).attr("style","max-width:"+i+"px;max-height:"+j+"px").html('<img src="'+(e.match(/^https?:/)?"":g)+e+h+'" alt="" />')):(c(b.el).find("input").attr("value",""),c(b.el).find('a[data-toggle="dropdown"]').removeClass(f.imageButtonClass).removeAttr("style").html(f.imageSelectorTitle||"Select..."))})}},radios:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><label class="radio"><input type="radio" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>"<%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %>/><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,inputfield:!0},radiobuttons:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><label class="radio btn"><input type="radio" style="position:absolute;left:-9999px;" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>" /><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtempate:!0,inputfield:!0,onInsert:function(a,b){var d="active",e=b.formElement||{};e.activeClass&&(d+=" "+e.activeClass),c(b.el).find("label").on("click",function(){c(this).parent().find("label").removeClass(d),c(this).addClass(d)})}},checkboxes:{template:"<div><%= choiceshtml %></div>",fieldtemplate:!0,inputfield:!0,onBeforeRender:function(a,b){var c=null,e=null,f='<label class="checkbox"><input type="checkbox" <% if (value) { %> checked="checked" <% } %> name="<%= name %>" value="1"<%= (node.disabled? " disabled" : "")%>/><span><%= title %></span></label>';b&&b.schemaElement&&b.schemaElement.items&&(c=b.schemaElement.items["enum"]||b.schemaElement.items[0]["enum"],c&&(e="",d.each(c,function(a,c){e+=d.template(f,{name:b.key+"["+c+"]",value:d.include(b.value,a),title:b.formElement.titleMap?b.formElement.titleMap[a]:a,node:b},g)}),a.choiceshtml=e))}},array:{template:'<div id="<%= id %>"><ul class="_jsonform-array-ul" style="list-style-type:none;"><%= children %></ul><span class="_jsonform-array-buttons"><a href="#" class="btn _jsonform-array-addmore"><i class="icon-plus-sign" title="Add new"></i></a> <a href="#" class="btn _jsonform-array-deletelast"><i class="icon-minus-sign" title="Delete last"></i></a></span></div>',fieldtemplate:!0,array:!0,childTemplate:function(a){return c("").sortable?'<li data-idx="<%= node.childPos %>"><span class="draggable line"><i class="icon-list" title="Move item"></i></span>'+a+"</li>":'<li data-idx="<%= node.childPos %>">'+a+"</li>"},onInsert:function(a,b){var d=c(b.el).find("#"+l(b.id)),e=b.getArrayBoundaries(),f=function(a,e){if(a!==e){var f=a<e?1:-1,g=0,h=c("> ul",d);for(g=a;g!==e;g+=f)b.children[g].switchValuesWith(b.children[g+f]),b.children[g].render(h.get(0)),b.children[g+f].render(h.get(0));var i=c(b.children[a].el),j=c(b.children[e].el);i.detach(),j.detach(),a<e?(0===a?h.prepend(i):c(b.children[a-1].el).after(i),c(b.children[e-1].el).after(j)):(0===e?h.prepend(j):c(b.children[e-1].el).after(j),c(b.children[a-1].el).after(i))}};c("> span > a._jsonform-array-addmore",d).click(function(a){a.preventDefault(),a.stopPropagation();var f=b.children.length;return!(e.maxItems>=0&&(b.children.length>e.maxItems-2&&d.find("> span > a._jsonform-array-addmore").addClass("disabled"),b.children.length>e.maxItems-1))&&(b.insertArrayItem(f,c("> ul",d).get(0)),void((e.minItems<=0||e.minItems>0&&b.children.length>e.minItems-1)&&d.find("> span > a._jsonform-array-deletelast").removeClass("disabled")))});var g=c("> ul > li",d).length;if(e.minItems>0&&g<e.minItems)for(var h=0;h<e.minItems-1&&d.find("> ul > li").length<e.minItems;h++)b.insertArrayItem(g,d.find("> ul").get(0));e.minItems>0&&b.children.length<=e.minItems&&d.find("> span > a._jsonform-array-deletelast").addClass("disabled"),c("> span > a._jsonform-array-deletelast",d).click(function(a){var c=b.children.length-1;if(a.preventDefault(),a.stopPropagation(),e.minItems>0){if(b.children.length<e.minItems+2&&d.find("> span > a._jsonform-array-deletelast").addClass("disabled"),b.children.length<=e.minItems)return!1}else 1===b.children.length&&d.find("> span > a._jsonform-array-deletelast").addClass("disabled");b.deleteArrayItem(c),e.maxItems>=0&&c<=e.maxItems-1&&d.find("> span > a._jsonform-array-addmore").removeClass("disabled")}),c(b.el).sortable&&(c("> ul",d).sortable(),c("> ul",d).bind("sortstop",function(a,b){
var d=c(b.item).data("idx"),e=c(b.item).index();f(d,e)}))}},tabarray:{template:'<div id="<%= id %>"><div class="tabbable tabs-left"><ul class="nav nav-tabs"><%= tabs %></ul><div class="tab-content"><%= children %></div></div><a href="#" class="btn _jsonform-array-addmore"><i class="icon-plus-sign" title="Add new"></i></a> <a href="#" class="btn _jsonform-array-deleteitem"><i class="icon-minus-sign" title="Delete item"></i></a></div>',fieldtemplate:!0,array:!0,childTemplate:function(a){return'<div data-idx="<%= node.childPos %>" class="tab-pane">'+a+"</div>"},onBeforeRender:function(a,b){var c="";d.each(b.children,function(a,b){var d=a.legend||a.title||"Item "+(b+1);c+='<li data-idx="'+b+'"'+(0===b?' class="active"':"")+'><a class="draggable tab" data-toggle="tab">'+k(d)+"</a></li>"}),a.tabs=c},onInsert:function(a,b){var e=c(b.el).find("#"+l(b.id)),f=b.getArrayBoundaries(),g=function(a,d){if(a!==d){var f=a<d?1:-1,g=0,h=c("> .tabbable > .tab-content",e).get(0);for(g=a;g!==d;g+=f)b.children[g].switchValuesWith(b.children[g+f]),b.children[g].render(h),b.children[g+f].render(h)}},h=function(a){var f="",g=!1;void 0===a&&(a=c("> .tabbable > .nav-tabs .active",e).data("idx"),a?a=parseInt(a,10):(g=!0,a=0)),a>=b.children.length&&(a=b.children.length-1),d.each(b.children,function(a,b){var c=a.legend||a.title||"Item "+(b+1);f+='<li data-idx="'+b+'"><a class="draggable tab" data-toggle="tab">'+k(c)+"</a></li>"}),c("> .tabbable > .nav-tabs",e).html(f),g&&c('> .tabbable > .nav-tabs [data-idx="0"]',e).addClass("active"),c('> .tabbable > .nav-tabs [data-toggle="tab"]',e).eq(a).click()};if(c("> a._jsonform-array-deleteitem",e).click(function(a){var d=c("> .tabbable > .nav-tabs .active",e).data("idx");return a.preventDefault(),a.stopPropagation(),!(f.minItems>0&&(b.children.length<f.minItems+1&&e.find("> a._jsonform-array-deleteitem").addClass("disabled"),b.children.length<=f.minItems))&&(b.deleteArrayItem(d),h(),(b.children.length<f.minItems+1||0===b.children.length)&&e.find("> a._jsonform-array-deleteitem").addClass("disabled"),void(f.maxItems>=0&&b.children.length<=f.maxItems&&e.find("> a._jsonform-array-addmore").removeClass("disabled")))}),c("> a._jsonform-array-addmore",e).click(function(a){var d=b.children.length;return!(f.maxItems>=0&&(b.children.length>f.maxItems-2&&c("> a._jsonform-array-addmore",e).addClass("disabled"),b.children.length>f.maxItems-1))&&(a.preventDefault(),a.stopPropagation(),b.insertArrayItem(d,e.find("> .tabbable > .tab-content").get(0)),h(d),void((f.minItems<=0||f.minItems>0&&d>f.minItems-1)&&e.find("> a._jsonform-array-deleteitem").removeClass("disabled")))}),c(b.el).on("legendUpdated",function(a){h(),a.preventDefault(),a.stopPropagation()}),c(b.el).sortable&&(c("> .tabbable > .nav-tabs",e).sortable({containment:b.el,tolerance:"pointer"}),c("> .tabbable > .nav-tabs",e).bind("sortstop",function(a,b){var d=c(b.item).data("idx"),e=c(b.item).index();g(d,e),h(e)})),f.minItems>=0){for(var i=0;i<f.minItems-1;i++)e.find("> a._jsonform-array-addmore").click();e.find("> a._jsonform-array-deleteitem").addClass("disabled"),h()}f.maxItems>=0&&b.children.length>=f.maxItems&&e.find("> a._jsonform-array-addmore").addClass("disabled"),f.minItems>=0&&b.children.length<=f.minItems&&e.find("> a._jsonform-array-deleteitem").addClass("disabled")}},help:{template:'<span class="help-block" style="padding-top:5px"><%= elt.helpvalue %></span>',fieldtemplate:!0},msg:{template:"<%= elt.msg %>"},fieldset:{template:'<fieldset class="control-group jsonform-error-<%= keydash %> <% if (elt.expandable) { %>expandable<% } %> <%= elt.htmlClass?elt.htmlClass:"" %>" <% if (id) { %> id="<%= id %>"<% } %>><% if (node.title || node.legend) { %><legend><%= node.title || node.legend %></legend><% } %><% if (elt.expandable) { %><div class="control-group"><% } %><%= children %><% if (elt.expandable) { %></div><% } %></fieldset>'},advancedfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable <%= elt.htmlClass?elt.htmlClass:"" %>"><legend>Advanced options</legend><div class="control-group"><%= children %></div></fieldset>'},authfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable <%= elt.htmlClass?elt.htmlClass:"" %>"><legend>Authentication settings</legend><div class="control-group"><%= children %></div></fieldset>'},submit:{template:'<input type="submit" <% if (id) { %> id="<%= id %>" <% } %> class="btn btn-primary <%= elt.htmlClass?elt.htmlClass:"" %>" value="<%= value || node.title %>"<%= (node.disabled? " disabled" : "")%>/>'},button:{template:' <button <% if (id) { %> id="<%= id %>" <% } %> class="btn <%= elt.htmlClass?elt.htmlClass:"" %>"><%= node.title %></button> '},actions:{template:'<div class="form-actions <%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},hidden:{template:'<input type="hidden" id="<%= id %>" name="<%= node.name %>" value="<%= escape(value) %>" />',inputfield:!0},selectfieldset:{template:'<fieldset class="tab-container <%= elt.htmlClass?elt.htmlClass:"" %>"><% if (node.legend) { %><legend><%= node.legend %></legend><% } %><% if (node.formElement.key) { %><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><% } else { %><a id="<%= node.id %>"></a><% } %><div class="tabbable"><div class="control-group<%= node.formElement.hideMenu ? " hide" : "" %>"><% if (node.title && !elt.notitle) { %><label class="control-label" for="<%= node.id %>"><%= node.title %></label><% } %><div class="controls"><%= tabs %></div></div><div class="tab-content"><%= children %></div></div></fieldset>',inputfield:!0,getElement:function(a){return c(a).parent().get(0)},childTemplate:function(a){return'<div data-idx="<%= node.childPos %>" class="tab-pane<% if (node.active) { %> active<% } %>">'+a+"</div>"},onBeforeRender:function(a,b){var c=null,e=[];b.schemaElement&&(e=b.schemaElement["enum"]||[]),c=b.options?d.map(b.options,function(a,c){var f=b.children[c];return a instanceof Object?(a=d.extend({node:f},a),a.title=a.title||f.legend||f.title||"Option "+(f.childPos+1),a.value=i(a.value)?a.value:i(e[c])?e[c]:c,a):{title:a,value:i(e[f.childPos])?e[f.childPos]:f.childPos,node:f}}):d.map(b.children,function(a,b){return{title:a.legend||a.title||"Option "+(a.childPos+1),value:e[a.childPos]||a.childPos,node:a}});var f=null;a.value&&(f=d.find(c,function(a){return a.value===b.value})),f||(f=d.find(c,function(a){return a.node.hasNonDefaultValue()})),f||(f=c[0]),f.node.active=!0,a.value=f.value;var g=(b.formElement,'<select class="nav"'+(b.disabled?" disabled":"")+">");return d.each(c,function(a,b){g+='<option data-idx="'+b+'" value="'+a.value+'"'+(a.node.active?' class="active"':"")+">"+k(a.title)+"</option>"}),g+="</select>",a.tabs=g,a},onInsert:function(a,b){c(b.el).find("select.nav").first().on("change",function(a){var d=c(this).find("option:selected");c(b.el).find('input[type="hidden"]').first().val(d.attr("value"))})}},optionfieldset:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},section:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},questions:{template:'<div><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><%= children %></div>',fieldtempate:!0,inputfield:!0,getElement:function(a){return c(a).parent().get(0)},onInsert:function(a,b){b.children&&0!==b.children.length&&(d.each(b.children,function(a){c(a.el).hide()}),c(b.children[0].el).show())}},question:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><label class="radio<%= (node.formElement.optionsType === "radiobuttons") ? " btn" : "" %><%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><input type="radio" <% if (node.formElement.optionsType === "radiobuttons") { %> style="position:absolute;left:-9999px;" <% } %>name="<%= node.id %>" value="<%= val %>"<%= (node.disabled? " disabled" : "")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,onInsert:function(a,b){var e="active",f=b.formElement||{};f.activeClass&&(e+=" "+f.activeClass),c(b.el).find('input[type="radio"]').on("change",function(a){var f=null,g=b.options[c(this).val()];b.parentNode&&b.parentNode.el&&(c(this).parent().parent().find("label").removeClass(e),c(this).parent().addClass(e),c(b.el).nextAll().hide(),c(b.el).nextAll().find('input[type="radio"]').prop("checked",!1),g.value&&c(b.parentNode.el).find('input[type="hidden"]').val(g.value),g.next&&(f=d.find(b.parentNode.children,function(a){return a.formElement&&a.formElement.qid===g.next}),c(f.el).show(),c(f.el).nextAll().hide(),c(f.el).nextAll().find('input[type="radio"]').prop("checked",!1)),g.href&&(g.target?window.open(g.href,g.target):window.location=g.href),g.submit&&setTimeout(function(){b.ownerTree.submit()},0))})}}},j.util.getObjKey=function(a,b,c){for(var e=a,g=b.split("."),h=null,i=null,j=null,k=0;k<g.length;k++){if(null===e||"object"!=typeof e)return null;if(h=g[k],j=h.replace(f,""),f.lastIndex=0,i=f.exec(h))for(;;){if(!d.isArray(e[j]))return null;if(e=e[j][parseInt(i[1],10)],i=f.exec(h),!i)break}else e=c&&!e[j]&&d.isArray(e)&&e[0]?e[0][j]:e[j]}return c&&d.isArray(e)&&e[0]?e[0]:e},j.util.setObjKey=function(a,b,c){for(var e=a,g=b.split("."),h=null,i=null,j=null,k=0;k<g.length-1;k++)if(h=g[k],j=h.replace(f,""),f.lastIndex=0,i=f.exec(h)){for(;;)if(d.isArray(e[j])||(e[j]=[]),e=e[j],j=parseInt(i[1],10),i=f.exec(h),!i)break;"object"==typeof e[j]&&null!==e[j]||(e[j]={}),e=e[j]}else"object"==typeof e[j]&&null!==e[j]||(e[j]={}),e=e[j];if(h=g[g.length-1],j=h.replace(f,""),f.lastIndex=0,i=f.exec(h)){for(;;)if(d.isArray(e[j])||(e[j]=[]),e=e[j],j=parseInt(i[1],10),i=f.exec(h),!i)break;e[j]=c}else e[j]=c};var p=function(a,b){var c=b.replace(/\./g,".properties.").replace(/\[[0-9]*\]/g,".items"),d=j.util.getObjKey(a,c,!0);if(d&&d.$ref)throw new Error("JSONForm does not yet support schemas that use the $ref keyword. See: https://github.com/joshfire/jsonform/issues/54");return d},q=function(a,b){var c=0,d=0;if(!a)return null;if(b>0)for(;c<b;){if(d=a.indexOf("[]",d),d===-1)return a;d+=2,c+=1}return d=a.indexOf("[]",d),d===-1?a:a.substring(0,d)},r=function(a,b){var c=0;if(!a)return null;if(!b||0===b.length)return a;var d=a.replace(f,function(a,d){var e=a;return i(b[c])&&(e="["+b[c]+"]"),c+=1,e});return d},s=function(a,b,c,e,f){var g=null;e=e||{},e.idx=e.idx||(c?c[c.length-1]:1),e.value=i(e.value)?e.value:"",e.getValue=e.getValue||function(b){return s(a,b,c,e,f)};var k=function(a,b){var c=null;return a&&a.length?(d.each(a,function(a){if(!c)return a===b?void(c={key:a}):void(d.isString(a)||(a.key===b?c=a:a.items&&(c=k(a.items,b))))}),c):null},l=k(a.form||[],b),m=p(a.schema.properties,b);return f&&a.value&&(g=j.util.getObjKey(a.value,r(b,c))),i(g)||(l&&"undefined"!=typeof l.value?g=l.value:m&&i(m["default"])&&(g=m["default"]),g&&g.indexOf("{{values.")!==-1&&(g=g.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}')),g&&(g=d.template(g,e,h))),i(g)&&l&&l.titleMap&&l.titleMap[g]&&(g=d.template(l.titleMap[g],e,h)),g&&d.isString(g)&&m&&m.maxLength&&g.length>m.maxLength&&(g=g.substr(0,m.maxLength-1)+"…"),i(g)?g:null},t=function(){this.id=null,this.key=null,this.el=null,this.formElement=null,this.schemaElement=null,this.view=null,this.children=[],this.ownerTree=null,this.parentNode=null,this.childTemplate=null,this.legendChild=null,this.arrayPath=[],this.childPos=0};t.prototype.clone=function(a){var b=new t;return b.arrayPath=d.clone(this.arrayPath),b.ownerTree=this.ownerTree,b.parentNode=a||this.parentNode,b.formElement=this.formElement,b.schemaElement=this.schemaElement,b.view=this.view,b.children=d.map(this.children,function(a){return a.clone(b)}),this.childTemplate&&(b.childTemplate=this.childTemplate.clone(b)),b},t.prototype.hasNonDefaultValue=function(){if(this.formElement&&"hidden"==this.formElement.type)return!1;if(this.value&&!this.defaultValue)return!0;var a=d.find(this.children,function(a){return a.hasNonDefaultValue()});return!!a},t.prototype.appendChild=function(a){return a.parentNode=this,a.childPos=this.children.length,this.children.push(a),a},t.prototype.removeChild=function(){var a=this.children[this.children.length-1];if(a)return c(a.el).remove(),this.children.pop()},t.prototype.moveValuesTo=function(a){var b=this.getFormValues(a.arrayPath);a.resetValues(),a.computeInitialValues(b,!0)},t.prototype.switchValuesWith=function(a){var b=this.getFormValues(a.arrayPath),c=a.getFormValues(this.arrayPath);a.resetValues(),a.computeInitialValues(b,!0),this.resetValues(),this.computeInitialValues(c,!0)},t.prototype.resetValues=function(){var a=null;if(this.value=null,this.parentNode?(this.arrayPath=d.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],this.view&&this.view.inputfield)a=c(":input",this.el).serializeArray(),d.each(a,function(a){c('[name="'+l(a.name)+'"]',c(this.el)).val("")},this);else if(this.view&&this.view.array)for(;this.children.length>0;)this.removeChild();d.each(this.children,function(a){a.resetValues()})},t.prototype.setChildTemplate=function(a){this.childTemplate=a,a.parentNode=this},t.prototype.computeInitialValues=function(a,b){var c=this,e=null,f=1,g=0,k=this.ownerTree.formDesc.tpldata||{};if(this.parentNode?(this.arrayPath=d.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],k.idx=this.arrayPath.length>0?this.arrayPath[this.arrayPath.length-1]+1:this.childPos+1,k.value="",k.getValue=function(b){return s(c.ownerTree.formDesc,b,c.arrayPath,k,!!a)},this.formElement&&(this.formElement.id?this.id=r(this.formElement.id,this.arrayPath):this.view&&this.view.array?this.id=l(this.ownerTree.formDesc.prefix)+"-elt-counter-"+d.uniqueId():this.parentNode&&this.parentNode.view&&this.parentNode.view.array?this.id=l(this.ownerTree.formDesc.prefix)+"-elt-counter-"+d.uniqueId():"button"!==this.formElement.type&&"selectfieldset"!==this.formElement.type&&"question"!==this.formElement.type&&"buttonquestion"!==this.formElement.type||(this.id=l(this.ownerTree.formDesc.prefix)+"-elt-counter-"+d.uniqueId()),this.formElement.key&&(this.key=r(this.formElement.key,this.arrayPath),this.keydash=this.key.replace(/\./g,"---")),this.name=r(this.formElement.name,this.arrayPath),d.each(["title","legend","description","append","prepend","inlinetitle","helpvalue","value","disabled","placeholder","readOnly"],function(a){d.isString(this.formElement[a])?(this.formElement[a].indexOf("{{values.")!==-1?this[a]=this.formElement[a].replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):this[a]=r(this.formElement[a],this.arrayPath),this[a]&&(this[a]=d.template(this[a],k,h))):this[a]=this.formElement[a]},this),this.formElement.options&&(this.options=d.map(this.formElement.options,function(a){var b=null;return d.isObject(a)&&a.title?(b=a.title.indexOf("{{values.")!==-1?a.title.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):r(a.title,c.arrayPath),d.extend({},a,{value:i(a.value)?a.value:"",title:d.template(b,k,h)})):a}))),this.view&&this.view.inputfield&&this.schemaElement)a?i(j.util.getObjKey(a,this.key))&&(this.value=j.util.getObjKey(a,this.key)):b||!i(this.value)&&i(this.schemaElement["default"])&&(this.value=this.schemaElement["default"],d.isString(this.value)&&(this.value.indexOf("{{values.")!==-1?this.value=this.value.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):this.value=r(this.value,this.arrayPath),this.value&&(this.value=d.template(this.value,k,h))),this.defaultValue=!0);else if(this.view&&this.view.array)for(f=0,a?f=this.getPreviousNumberOfItems(a,this.arrayPath):0===f&&(f=1),g=0;g<f;g++)this.appendChild(this.childTemplate.clone());if(d.each(this.children,function(c){c.computeInitialValues(a,b)}),this.formElement&&this.formElement.valueInLegend)for(e=this;e;){if(e.parentNode&&e.parentNode.view&&e.parentNode.view.array&&(e.legendChild=this,e.formElement&&e.formElement.legend)){e.legend=r(e.formElement.legend,e.arrayPath),k.idx=e.arrayPath.length>0?e.arrayPath[e.arrayPath.length-1]+1:e.childPos+1,k.value=i(this.value)?this.value:"",e.legend=d.template(e.legend,k,h);break}e=e.parentNode}},t.prototype.getPreviousNumberOfItems=function(a,b){var c=null,e=null,f=null;return a?this.view.inputfield&&this.schemaElement?(c=q(this.formElement.key,b.length),c=r(c,b),(e=j.util.getObjKey(a,c))?(f=d.map(this.children,function(c){return c.getPreviousNumberOfItems(a,b)}),d.max([d.max(f)||0,e.length])):0):this.view.array?this.childTemplate.getPreviousNumberOfItems(a,b):(f=d.map(this.children,function(c){return c.getPreviousNumberOfItems(a,b)}),d.max(f)||0):0},t.prototype.getFormValues=function(a){var b={};if(!this.el)throw new Error("formNode.getFormValues can only be called on nodes that are associated with a DOM element in the tree");var f=c(":input",this.el).serializeArray();f=f.concat(c(":input[type=checkbox]:not(:disabled):not(:checked)",this.el).map(function(){return{name:this.name,value:this.checked}}).get()),a&&d.each(f,function(b){b.name=r(b.name,a)});for(var g=this.ownerTree.formDesc.schema,h=0;h<f.length;h++){var i=f[h].name,k=p(g.properties,i),l=null,m=null;if(k)if(k._jsonform_checkboxes_as_array&&(l=i.match(/\[([0-9]*)\]$/)))i=i.replace(/\[([0-9]*)\]$/,""),m=j.util.getObjKey(b,i)||[],"1"===f[h].value&&m.push(k["enum"][parseInt(l[1],10)]),j.util.setObjKey(b,i,m);else{if("boolean"===k.type&&("0"===f[h].value?f[h].value=!1:f[h].value=!!f[h].value),"number"!==k.type&&"integer"!==k.type||d.isString(f[h].value)&&(f[h].value.length?isNaN(Number(f[h].value))||(f[h].value=Number(f[h].value)):f[h].value=null),"string"!==k.type||""!==f[h].value||k._jsonform_allowEmpty||(f[h].value=null),"object"===k.type&&d.isString(f[h].value)&&"{"===f[h].value.substring(0,1))try{f[h].value=e.parse(f[h].value)}catch(n){f[h].value={}}"object"!==k.type||"null"!==f[h].value&&""!==f[h].value||(f[h].value=null),f[h].name&&null!==f[h].value&&j.util.setObjKey(b,f[h].name,f[h].value)}}return b},t.prototype.render=function(a){var b=this.generate();this.setContent(b,a),this.enhance()},t.prototype.setContent=function(a,b){var d=c(a),e=b||(this.parentNode?this.parentNode.el:this.ownerTree.domRoot),f=null;this.el?c(this.el).replaceWith(d):(f=c(e).children().get(this.childPos),f?c(f).before(d):c(e).append(d)),this.el=d,this.updateElement(this.el)},t.prototype.updateElement=function(a){this.id&&(this.el=c("#"+l(this.id),a).get(0),this.view&&this.view.getElement&&(this.el=this.view.getElement(this.el)),this.fieldtemplate!==!1&&this.view&&this.view.fieldtemplate&&(this.el=c(this.el).parent().parent(),(this.prepend||this.prepend)&&(this.el=this.el.parent()),this.el=this.el.get(0)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(this.el=c(this.el).parent().get(0))),d.each(this.children,function(b){b.updateElement(this.el||a)})},t.prototype.generate=function(){var a={id:this.id,keydash:this.keydash,elt:this.formElement,schema:this.schemaElement,node:this,value:i(this.value)?this.value:"",escape:k},b=null,c="";this.ownerTree.formDesc.onBeforeRender&&this.ownerTree.formDesc.onBeforeRender(a,this),this.view.onBeforeRender&&this.view.onBeforeRender(a,this),b=this.template?this.template:this.formElement&&this.formElement.template?this.formElement.template:this.view.template,this.fieldtemplate!==!1&&(this.fieldtemplate||this.view.fieldtemplate)&&(b=j.fieldTemplate(b)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(b=this.parentNode.view.childTemplate(b));var e="";return d.each(this.children,function(a){e+=a.generate()}),a.children=e,a.fieldHtmlClass="",this.ownerTree&&this.ownerTree.formDesc&&this.ownerTree.formDesc.params&&this.ownerTree.formDesc.params.fieldHtmlClass&&(a.fieldHtmlClass=this.ownerTree.formDesc.params.fieldHtmlClass),this.formElement&&"undefined"!=typeof this.formElement.fieldHtmlClass&&(a.fieldHtmlClass=this.formElement.fieldHtmlClass),c=d.template(b,a,g)},t.prototype.enhance=function(){var a=this,b=null,e=null,f=d.clone(this.ownerTree.formDesc.tpldata)||{};this.formElement&&(this.view.onInsert&&this.view.onInsert({target:c(this.el)},this),b=this.handlers||this.formElement.handlers,e=this.onInsert||this.formElement.onInsert,e&&e({target:c(this.el)},this),b&&d.each(b,function(a,b){"insert"===b&&a({target:c(this.el)},this)},this),this.el&&(this.onChange&&c(this.el).bind("change",function(b){a.onChange(b,a)}),this.view.onChange&&c(this.el).bind("change",function(b){a.view.onChange(b,a)}),this.formElement.onChange&&c(this.el).bind("change",function(b){a.formElement.onChange(b,a)}),this.onClick&&c(this.el).bind("click",function(b){a.onClick(b,a)}),this.view.onClick&&c(this.el).bind("click",function(b){a.view.onClick(b,a)}),this.formElement.onClick&&c(this.el).bind("click",function(b){a.formElement.onClick(b,a)}),this.onKeyUp&&c(this.el).bind("keyup",function(b){a.onKeyUp(b,a)}),this.view.onKeyUp&&c(this.el).bind("keyup",function(b){a.view.onKeyUp(b,a)}),this.formElement.onKeyUp&&c(this.el).bind("keyup",function(b){a.formElement.onKeyUp(b,a)}),b&&d.each(b,function(b,d){"insert"!==d&&c(this.el).bind(d,function(c){b(c,a)})},this)),this.legendChild&&this.legendChild.formElement&&c(this.legendChild.el).bind("keyup",function(b){a.formElement&&a.formElement.legend&&a.parentNode&&(a.legend=r(a.formElement.legend,a.arrayPath),f.idx=a.arrayPath.length>0?a.arrayPath[a.arrayPath.length-1]+1:a.childPos+1,f.value=c(b.target).val(),a.legend=d.template(a.legend,f,h),c(a.parentNode.el).trigger("legendUpdated"))})),d.each(this.children,function(a){a.enhance()})},t.prototype.insertArrayItem=function(a,b){var c=0;void 0===a&&(a=this.children.length);var d=this.childTemplate.clone();for(this.appendChild(d),d.resetValues(),c=this.children.length-2;c>=a;c--)this.children[c].moveValuesTo(this.children[c+1]);for(this.children[a].resetValues(),this.children[a].computeInitialValues(),c=a;c<this.children.length;c++)this.children[c].render(b)},t.prototype.deleteArrayItem=function(a){var b=0;for(void 0===a&&(a=this.children.length-1),b=a;b<this.children.length-1;b++)this.children[b+1].moveValuesTo(this.children[b]),this.children[b].render();this.removeChild()},t.prototype.getArrayBoundaries=function(){var a={minItems:-1,maxItems:-1};if(!this.view||!this.view.array)return a;var b=function(a,c){var e=null,f=null,g={minItems:-1,maxItems:-1};return c=c||a,a.view&&a.view.array&&a!==c?g:a.key?(f=a.key.replace(/\[[0-9]+\]/g,"[]"),a!==c&&(f=f.replace(/\[\][^\[\]]*$/,"")),e=p(a.ownerTree.formDesc.schema.properties,f),e?{minItems:e.minItems||e.minLength||-1,maxItems:e.maxItems||e.maxLength||-1}:g):(d.each(a.children,function(a){var d=b(a,c);d.minItems!==-1&&(g.minItems!==-1?g.minItems=Math.max(g.minItems,d.minItems):g.minItems=d.minItems),d.maxItems!==-1&&(g.maxItems!==-1?g.maxItems=Math.min(g.maxItems,d.maxItems):g.maxItems=d.maxItems)}),g)};return b(this)};var u=function(){this.eventhandlers=[],this.root=null,this.formDesc=null};u.prototype.initialize=function(a){a=a||{},this.formDesc=d.clone(a),this.formDesc.prefix=this.formDesc.prefix||"jsonform-"+d.uniqueId(),this.formDesc.schema&&!this.formDesc.schema.properties&&(this.formDesc.schema={properties:this.formDesc.schema}),this.formDesc.form=this.formDesc.form||["*",{type:"actions",items:[{type:"submit",value:"Submit"}]}],this.formDesc.form=d.isArray(this.formDesc.form)?this.formDesc.form:[this.formDesc.form],this.formDesc.params=this.formDesc.params||{},this.root=new t,this.root.ownerTree=this,this.root.view=j.elementTypes.root,this.buildTree(),this.computeInitialValues()},u.prototype.buildTree=function(){d.each(this.formDesc.form,function(a){"*"===a?d.each(this.formDesc.schema.properties,function(a,b){this.root.appendChild(this.buildFromLayout({key:b}))},this):(d.isString(a)&&(a={key:a}),this.root.appendChild(this.buildFromLayout(a)))},this)},u.prototype.buildFromLayout=function(a,b){var c=null,e=new t,f=null,g=null;if(a=d.clone(a),a.items&&(d.isArray(a.items)?a.items=d.map(a.items,d.clone):a.items=[d.clone(a.items)]),a.key){if(c=p(this.formDesc.schema.properties,a.key),!c)throw new Error('The JSONForm object references the schema key "'+a.key+'" but that key does not exist in the JSON schema');if(this.formDesc.onElementSchema&&this.formDesc.onElementSchema(a,c),a.name=a.name||a.key,a.title=a.title||c.title,a.description=a.description||c.description,a.readOnly=a.readOnly||c.readOnly||a.readonly||c.readonly,a.id||(a.id=l(this.formDesc.prefix)+"-elt-"+a.key),a.allowEmpty&&(c._jsonform_allowEmpty=!0),a.type||("string"===c.type&&"color"===c.format?a.type="color":"number"!==c.type&&"integer"!==c.type&&"string"!==c.type&&"any"!==c.type||c["enum"]?"boolean"===c.type?a.type="checkbox":"object"===c.type?c.properties?a.type="fieldset":a.type="textarea":d.isUndefined(c["enum"])?a.type=c.type:a.type="select":a.type="text"),!a.options&&c["enum"]&&(a.titleMap?a.options=d.map(c["enum"],function(b){return{value:b,title:a.titleMap[b]||b}}):a.options=c["enum"]),"checkboxes"===a.type&&c.items){var h=c.items["enum"];h&&(c.items._jsonform_checkboxes_as_array=!0),!h&&c.items[0]&&(h=c.items[0]["enum"],h&&(c.items[0]._jsonform_checkboxes_as_array=!0))}"object"===c.type&&d.each(c.properties,function(b,c){e.appendChild(this.buildFromLayout({key:a.key+"."+c}))},this)}if(a.type||(a.type="none"),f=j.elementTypes[a.type],!f)throw new Error('The JSONForm contains an element whose type is unknown: "'+a.type+'"');if(c){if(!f.inputfield&&!f.array&&"selectfieldset"!==a.type&&"object"!==c.type)throw new Error('The JSONForm contains an element that links to an element in the JSON schema (key: "'+a.key+'") and that should not based on its type ("'+a.type+'")')}else if(f.inputfield&&"selectfieldset"!==a.type)throw new Error('The JSONForm defines an element of type "'+a.type+'" but no "key" property to link the input field to the JSON schema');return a.iddot=l(a.id||""),e.formElement=a,e.schemaElement=c,e.view=f,e.ownerTree=this,a.handlers||(a.handlers={}),e.view.array?(g=a.items?a.items[0]||a.items:a.key+"[]",d.isString(g)&&(g={key:g}),e.setChildTemplate(this.buildFromLayout(g))):a.items&&d.each(a.items,function(a){d.isString(a)&&(a={key:a}),e.appendChild(this.buildFromLayout(a))},this),e},u.prototype.computeInitialValues=function(){this.root.computeInitialValues(this.formDesc.value)},u.prototype.render=function(a){a&&(this.domRoot=a,this.root.render(),this.hasRequiredField()&&c(a).addClass("jsonform-hasrequired"))},u.prototype.forEachElement=function(a){var b=function(c){for(var d=0;d<c.children.length;d++)a(c.children[d]),b(c.children[d])};b(this.root)},u.prototype.validate=function(a){var d=j.getFormValue(this.domRoot),e=!1,f=this.formDesc;if(f.validate!==!1){var g=!1;if("object"!=typeof f.validate?b.JSONFormValidator&&(g=b.JSONFormValidator.createEnvironment("json-schema-draft-03")):g=f.validate,g){var h=g.validate(d,this.formDesc.schema);c(this.domRoot).jsonFormErrors(!1,f),h.errors.length&&(e||(e=[]),e=e.concat(h.errors))}}return e&&!a&&(f.displayErrors?f.displayErrors(e,this.domRoot):c(this.domRoot).jsonFormErrors(e,f)),{errors:e}},u.prototype.submit=function(a){var b=function(){return a&&(a.preventDefault(),a.stopPropagation()),!1},c=j.getFormValue(this.domRoot),d=this.formDesc,e=!1;if(this.forEachElement(function(b){e||b.view.onSubmit&&(e=!b.view.onSubmit(a,b))}),e)return b();var f=this.validate();return d.onSubmit&&!d.onSubmit(f.errors,c)?b():f.errors?b():!(!d.onSubmitValid||d.onSubmitValid(c))&&b()},u.prototype.hasRequiredField=function(){var a=function(b){if(!b)return null;if(b.required&&"boolean"!==b.type)return b;var c=d.find(b.properties,function(b){return a(b)});return c?c:b.items&&(c=d.isArray(b.items)?d.find(b.items,function(b){return a(b)}):a(b.items))?c:void 0};return a(this.formDesc.schema)},j.getFormValue=function(a){var b=c(a).data("jsonform-tree");return b?b.root.getFormValues():null},c.fn.jsonFormErrors=function(a,b){if(c(".error",this).removeClass("error"),c(".warning",this).removeClass("warning"),c(".jsonform-errortext",this).hide(),a){for(var d=[],e=0;e<a.length;e++){var f=a[e].uri.replace(/.*#\//,"").replace(/\//g,".").replace(/\.([0-9]+)(?=\.|$)/g,"[$1]"),g=".jsonform-error-"+l(f.replace(/\./g,"---"));d.push(g);var h=a[e].type||"error";c(g,this).addClass(h),c(g+" .jsonform-errortext",this).html(a[e].message).show()}d=d.join(",");var i=c(d).get(0);i&&i.scrollIntoView&&i.scrollIntoView(!0,{behavior:"smooth"})}},c.fn.jsonForm=function(a){var b=this;a=d.defaults({},a,{submitEvent:"submit"});var f=new u;return f.initialize(a),f.render(b.get(0)),a.transloadit&&b.append('<input type="hidden" name="params" value=\''+k(e.stringify(a.transloadit.params))+"'>"),b.data("jsonform-tree",f),a.submitEvent&&(b.unbind(a.submitEvent+".jsonform"),b.bind(a.submitEvent+".jsonform",function(a){f.submit(a)})),m(b),c(".expandable > div, .expandable > fieldset",b).hide(),c(".expandable > legend",b).click(function(){var a=c(this).parent();a.toggleClass("expanded"),c("> div",a).slideToggle(100)}),f},c.fn.jsonFormValue=function(){return j.getFormValue(this)},b.JSONForm=b.JSONForm||{util:{}},b.JSONForm.getFormValue=j.getFormValue,b.JSONForm.fieldTemplate=j.fieldTemplate,b.JSONForm.fieldTypes=j.elementTypes,b.JSONForm.getInitialValue=s,b.JSONForm.util.getObjKey=j.util.getObjKey,b.JSONForm.util.setObjKey=j.util.setObjKey}("undefined"!=typeof exports,"undefined"!=typeof exports?exports:window,"undefined"!=typeof jQuery?jQuery:{fn:{}},"undefined"!=typeof _?_:null,JSON);